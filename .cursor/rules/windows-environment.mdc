---
globs: "*.bat,*.ps1,*.cmd"
description: "Windows environment specific practices and batch scripting"
---

# Windows ç¯å¢ƒå¼€å‘è§„èŒƒ ğŸªŸ

## æ‰¹å¤„ç†æ–‡ä»¶ (.bat)
- ä½¿ç”¨ ASCII å­—ç¬¦ç¼–ç ï¼Œé¿å…ä¸­æ–‡å­—ç¬¦å¯¼è‡´ä¹±ç 
- æ¯ä¸ªæ‰¹å¤„ç†æ–‡ä»¶å¼€å¤´æ·»åŠ  `@echo off` å‡å°‘è¾“å‡ºå¹²æ‰°
- ä½¿ç”¨ `chcp 65001` è®¾ç½® UTF-8 ç¼–ç é¡µï¼ˆå¦‚éœ€è¦ï¼‰
- é”™è¯¯å¤„ç†ä½¿ç”¨ `if errorlevel` æˆ– `if %errorlevel%`

## PowerShell è„šæœ¬ (.ps1)
- ä½¿ç”¨ UTF-8 ç¼–ç ä¿å­˜è„šæœ¬æ–‡ä»¶
- è„šæœ¬å¼€å¤´è®¾ç½®æ‰§è¡Œç­–ç•¥æé†’
- ä½¿ç”¨ `try-catch` å—å¤„ç†å¼‚å¸¸
- ä¼˜å…ˆä½¿ç”¨ PowerShell cmdlets è€Œéä¼ ç»Ÿå‘½ä»¤

## è·¯å¾„å¤„ç†
- ä½¿ç”¨åæ–œæ  `\` ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦
- å¤„ç†åŒ…å«ç©ºæ ¼çš„è·¯å¾„æ—¶ä½¿ç”¨åŒå¼•å·
- é¿å…ç¡¬ç¼–ç ç»å¯¹è·¯å¾„ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„æˆ–ç¯å¢ƒå˜é‡
- ä½¿ç”¨ `%~dp0` è·å–æ‰¹å¤„ç†æ–‡ä»¶æ‰€åœ¨ç›®å½•

## ç¯å¢ƒå˜é‡
- ä½¿ç”¨ `%USERPROFILE%` ä»£æ›¿ `~`
- ä½¿ç”¨ `%APPDATA%` å­˜å‚¨åº”ç”¨æ•°æ®
- æ£€æŸ¥å¿…è¦çš„ç¯å¢ƒå˜é‡æ˜¯å¦å­˜åœ¨

## æƒé™ç®¡ç†
- æ£€æŸ¥ç®¡ç†å‘˜æƒé™ï¼Œé¿å…æƒé™ä¸è¶³é”™è¯¯
- ä½¿ç”¨ `powershell -Command` æ‰§è¡Œéœ€è¦æå‡æƒé™çš„å‘½ä»¤
- æä¾›éç®¡ç†å‘˜æ¨¡å¼çš„æ›¿ä»£æ–¹æ¡ˆ

## å¸¸ç”¨å‘½ä»¤æ˜ å°„
- ä½¿ç”¨ `dir` ä»£æ›¿ `ls`
- ä½¿ç”¨ `type` ä»£æ›¿ `cat`
- ä½¿ç”¨ `del` ä»£æ›¿ `rm`
- ä½¿ç”¨ `copy` ä»£æ›¿ `cp`

## ç¼–ç å…¼å®¹æ€§
- å¤„ç† GBK ç¼–ç çš„æ–‡ä»¶æ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„
- æ–‡ä»¶è¯»å†™ç»Ÿä¸€ä½¿ç”¨ UTF-8 ç¼–ç 
- å‘½ä»¤è¡Œè¾“å‡ºå¯èƒ½éœ€è¦ç¼–ç è½¬æ¢

## è™šæ‹Ÿç¯å¢ƒ
- ä½¿ç”¨ `venv` æˆ– `conda` ç®¡ç†Pythonç¯å¢ƒ
- æ¿€æ´»è„šæœ¬è·¯å¾„ï¼š`venv\Scripts\activate.bat`
- åœ¨æ‰¹å¤„ç†ä¸­è‡ªåŠ¨æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

## ç¤ºä¾‹æ¨¡æ¿
```batch
@echo off
setlocal enabledelayedexpansion
cd /d "%~dp0"

:: æ£€æŸ¥Pythonç¯å¢ƒ
python --version >nul 2>&1
if errorlevel 1 (
    echo Python not found!
    pause
    exit /b 1
)

:: æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
if exist venv\Scripts\activate.bat (
    call venv\Scripts\activate.bat
)

:: è¿è¡Œä¸»ç¨‹åº
python launcher.py
if errorlevel 1 (
    echo Error occurred!
    pause
    exit /b 1
)
```
